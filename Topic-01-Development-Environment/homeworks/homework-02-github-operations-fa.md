# تمرین دوم: عملیات GitHub و مدیریت مخزن

## اهداف یادگیری
با تکمیل این تمرین، شما قادر خواهید بود:
- مخازن GitHub را ایجاد و مدیریت کنید
- از Personal Access Tokens برای احراز هویت استفاده کنید
- مخازن را با استفاده از احراز هویت PAT کلون کنید
- عملیات بازیابی Git را برای فایل‌ها و کامیت‌ها انجام دهید
- عملیات مخازن راه دور را درک کنید

## پیش‌نیازها
- حساب GitHub با Personal Access Token (به Tutorial 4 مراجعه کنید)
- Git نصب و پیکربندی شده
- دانش پایه Git از تمرین اول
- درک Personal Access Tokens در GitHub

## دستورالعمل‌ها

### قسمت ۱: تنظیم مخزن GitHub

۱. **یک مخزن GitHub جدید ایجاد کنید:**
   - به GitHub.com بروید و وارد شوید
   - روی آیکون "+" کلیک کنید → "New repository"
   - نام مخزن: `advanced-programming-hw2-[شماره-دانشجویی-شما]`
   - توضیحات: "تمرین دوم: عملیات GitHub و دستورات بازیابی"
   - روی **Public** تنظیم کنید (برای دسترسی آسان‌تر در طول یادگیری)
   - **مخزن را با README، .gitignore یا license مقداردهی اولیه نکنید**
   - روی "Create repository" کلیک کنید

۲. **URL مخزن خود را یادداشت کنید:**
   پس از ایجاد، GitHub URL مخزن را به شما نشان می‌دهد. باید شبیه این باشد:
   ```
   https://github.com/YOUR_USERNAME/advanced-programming-hw2-YOUR_STUDENT_ID.git
   ```

### قسمت ۲: تنظیم مخزن محلی و کامیت اولیه

۱. **یک پوشه پروژه محلی ایجاد کنید:**
   ```bash
   # پوشه برای این تمرین ایجاد کنید
   mkdir github-operations-hw2
   cd github-operations-hw2
   ```

۲. **مخزن Git را مقداردهی اولیه کنید:**
   ```bash
   git init
   ```

۳. **ساختار پروژه اولیه را ایجاد کنید:**
   ```
   github-operations-hw2/
   ├── README.md
   ├── src/
   │   ├── main.py
   │   ├── utils.py
   │   └── config.py
   ├── tests/
   │   ├── test_main.py
   │   └── test_utils.py
   └── docs/
       ├── user-guide.md
       └── api-reference.md
   ```

۴. **فایل‌های اولیه را ایجاد کنید:**

   **README.md:**
   ```markdown
   # تمرین عملیات GitHub ۲

   **اطلاعات دانشجو:**
   - شماره دانشجویی: [شماره دانشجویی شما]
   - نام: [نام کامل شما]
   - نام خانوادگی: [نام خانوادگی شما]

   ## توضیحات پروژه
   این پروژه عملیات GitHub شامل ایجاد مخزن،
   احراز هویت Personal Access Token و عملیات بازیابی Git را نشان می‌دهد.

   ## ساختار پروژه
   - `src/`: کد منبع اصلی
   - `tests/`: تست‌های واحد
   - `docs/`: فایل‌های مستندات

   ## مخزن GitHub
   این پروژه با استفاده از احراز هویت Personal Access Token به GitHub پوش خواهد شد.
   ```

   **src/main.py:**
   ```python
   # فایل برنامه اصلی
   # شماره دانشجویی: [شماره دانشجویی شما]

   print("=== تمرین عملیات GitHub ===")
   print("به تمرین عملیات GitHub ۲ خوش آمدید!")
   print("شماره دانشجویی: YOUR_STUDENT_ID")
   print("دوره: برنامه‌نویسی پیشرفته")
   ```

   **src/utils.py:**
   ```python
   # توابع کاربردی
   # شماره دانشجویی: [شماره دانشجویی شما]

   print("=== توابع کاربردی ===")
   print("این فایل شامل توابع کاربردی برای تمرین است.")
   print("محاسبات ساده: 10 + 5 =", 10 + 5)
   ```

   **src/config.py:**
   ```python
   # تنظیمات پیکربندی
   # شماره دانشجویی: [شماره دانشجویی شما]

   print("=== تنظیمات پیکربندی ===")
   print("نام برنامه: دموی عملیات GitHub")
   print("نسخه: 1.0.0")
   print("نویسنده: YOUR_NAME")
   ```

۵. **کامیت اولیه:**
   ```bash
   git add .
   git commit -m "کامیت اولیه: ساختار پروژه و فایل‌های پایه"
   ```

### قسمت ۳: اتصال به مخزن GitHub

۱. **راه دور GitHub را با استفاده از Personal Access Token اضافه کنید:**
   ```bash
   # YOUR_USERNAME، YOUR_PAT و YOUR_STUDENT_ID را با مقادیر واقعی جایگزین کنید
   git remote add origin https://YOUR_USERNAME:YOUR_PAT@github.com/YOUR_USERNAME/advanced-programming-hw2-YOUR_STUDENT_ID.git
   ```

۲. **به GitHub پوش کنید:**
   ```bash
   git push -u origin main
   ```

۳. **روی GitHub تأیید کنید:**
   - به مخزن خود روی GitHub بروید
   - تأیید کنید همه فایل‌ها آپلود شده‌اند
   - تاریخچه کامیت را بررسی کنید

### قسمت ۴: ایجاد فایل‌های مستندات

   **docs/user-guide.md:**
   ```markdown
   # راهنمای کاربر

   ## شروع کار

   این پروژه عملیات GitHub و مدیریت مخزن را نشان می‌دهد.

   ## نصب

   ۱. مخزن را کلون کنید:
   ```bash
   git clone https://YOUR_USERNAME:YOUR_PAT@github.com/YOUR_USERNAME/advanced-programming-hw2-YOUR_STUDENT_ID.git
   ```

   ۲. به دایرکتوری پروژه بروید:
   ```bash
   cd advanced-programming-hw2-YOUR_STUDENT_ID
   ```

   ۳. برنامه اصلی را اجرا کنید:
   ```bash
   python src/main.py
   ```

   ## استفاده

   ### پیکربندی
   فایل `src/config.py` را برای تغییر تنظیمات برنامه ویرایش کنید.

   ## ویژگی‌ها

   - نمایش اطلاعات دانشجو
   - توابع کاربردی ساده
   - مدیریت پیکربندی
   ```

   **docs/api-reference.md:**
   ```markdown
   # مرجع API

   ## فایل‌ها

   ### main.py
   فایل برنامه اصلی که پیام‌های خوشامدگویی و اطلاعات دانشجو را نمایش می‌دهد.

   ### utils.py
   شامل توابع کاربردی و محاسبات ساده است.

   ### config.py
   فایل پیکربندی با تنظیمات برنامه.
   ```

۳. **فایل‌های جدید را کامیت کنید:**
   ```bash
   git add .
   git commit -m "افزودن فایل‌های مستندات"
   git push origin main
   ```

### قسمت ۵: عملیات بازیابی Git

#### ۵.۱ بازیابی یک فایل

۱. **یک فایل را تغییر دهید (تغییرات تصادفی را شبیه‌سازی کنید):**
   ```bash
   # تغییراتی در src/utils.py ایجاد کنید
   echo "# این یک تغییر تصادفی است" >> src/utils.py
   ```

۲. **وضعیت را بررسی کنید:**
   ```bash
   git status
   ```
   باید `src/utils.py` را به عنوان تغییر یافته ببینید.

۳. **فایل را به حالت آخرین کامیت بازیابی کنید:**
   ```bash
   git restore src/utils.py
   ```

۴. **تأیید کنید که فایل بازیابی شده:**
   ```bash
   git status
   git diff src/utils.py
   ```

#### ۵.۲ بازیابی چندین فایل

۱. **چندین فایل را تغییر دهید:**
   ```bash
   # چندین فایل را تغییر دهید
   echo "# تغییر تصادفی ۱" >> src/main.py
   echo "# تغییر تصادفی ۲" >> README.md
   echo "# تغییر تصادفی ۳" >> src/config.py
   ```

۲. **وضعیت را بررسی کنید:**
   ```bash
   git status
   ```

۳. **تمام فایل‌های تغییر یافته را بازیابی کنید:**
   ```bash
   git restore .
   ```

۴. **تأیید کنید که همه فایل‌ها بازیابی شده‌اند:**
   ```bash
   git status
   ```

#### ۵.۳ بازیابی یک کامیت خاص (کل مخزن)

۱. **تغییراتی ایجاد و کامیت کنید:**
   ```bash
   # فایلی را تغییر دهید
   echo "# تغییر موقت برای نمایش بازیابی" >> src/utils.py

   # تغییر را کامیت کنید
   git add src/utils.py
   git commit -m "کامیت موقت برای نمایش بازیابی"
   ```

۲. **تاریخچه کامیت را بررسی کنید:**
   ```bash
   git log --oneline
   ```
   هش کامیت "کامیت موقت" را یادداشت کنید (مثلاً abc1234).

۳. **تغییرات بیشتری ایجاد کنید:**
   ```bash
   # تغییرات اضافی ایجاد کنید
   echo "# تغییرات بیشتر" >> src/main.py
   echo "# حتی تغییرات بیشتر" >> README.md
   ```

۴. **کل مخزن را به کامیت قبلی بازیابی کنید:**
   ```bash
   # abc1234 را با هش کامیت واقعی جایگزین کنید
   git reset --hard abc1234
   ```

۵. **بازیابی را تأیید کنید:**
   ```bash
   git status
   git log --oneline
   ```

۶. **توجه:** این عملیات تغییرات کامیت نشده را به طور دائمی حذف می‌کند و به کامیت مشخص شده بازنشانی می‌کند.

### قسمت ۶: عملیات بازیابی پیشرفته

#### ۶.۱ بازیابی فایل‌های stage شده

۱. **تغییراتی را stage کنید:**
   ```bash
   # فایل‌ها را تغییر و stage کنید
   echo "# تغییر stage شده" >> src/config.py
   git add src/config.py
   ```

۲. **وضعیت را بررسی کنید:**
   ```bash
   git status
   ```

۳. **فایل را از ناحیه staging unstaged کنید (از ناحیه staging بازیابی کنید):**
   ```bash
   git restore --staged src/config.py
   ```

۴. **تأیید کنید:**
   ```bash
   git status
   ```

#### ۶.۲ Soft Reset در مقابل Hard Reset

۱. **یک کامیت جدید ایجاد کنید:**
   ```bash
   echo "# کامیت دمو" >> docs/user-guide.md
   git add docs/user-guide.md
   git commit -m "کامیت دمو برای مقایسه reset"
   ```

۲. **تغییرات بیشتری ایجاد کنید:**
   ```bash
   echo "# تغییرات بیشتر برای reset دمو" >> docs/api-reference.md
   ```

۳. **soft reset را نشان دهید (تغییرات را نگه می‌دارد):**
   ```bash
   git reset --soft HEAD~1
   git status
   ```
   توجه کنید که تغییرات هنوز وجود دارند اما unstaged هستند.

۴. **mixed reset را نشان دهید (پیش‌فرض):**
   ```bash
   git add docs/api-reference.md
   git commit -m "کامیت دمو دیگر"
   git reset HEAD~1
   git status
   ```

۵. **hard reset را نشان دهید:**
   ```bash
   git add docs/api-reference.md
   git commit -m "کامیت دمو نهایی"
   git reset --hard HEAD~1
   git status
   ```

### قسمت ۷: مدیریت نهایی مخزن

۱. **یک به‌روزرسانی جامع ایجاد کنید:**
   بخشی درباره عملیات بازیابی Git به README اصلی اضافه کنید و تمام فایل‌ها را با اطلاعات واقعی دانشجویی خود به‌روزرسانی کنید.

۲. **کامیت و پوش نهایی:**
   ```bash
   git add .
   git commit -m "تکمیل تمرین دوم با نمایش عملیات بازیابی"
   git push origin main
   ```

۳. **مخزن نهایی را تأیید کنید:**
   - مخزن GitHub را بررسی کنید
   - اطمینان حاصل کنید همه فایل‌ها حضور دارند
   - تاریخچه کامیت را بررسی کنید

## ساختار مخزن مورد انتظار

```
advanced-programming-hw2-YOUR_STUDENT_ID/
├── README.md                    # مستندات پروژه اصلی
├── src/                        # کد منبع
│   ├── main.py                 # برنامه اصلی
│   ├── utils.py                # توابع کاربردی
│   └── config.py               # پیکربندی
└── docs/                       # مستندات
    ├── user-guide.md          # راهنمای کاربر
    └── api-reference.md       # مرجع API
```

## دستورات Git استفاده شده در این تمرین

| دستور | هدف |
|---------|---------|
| `git init` | مقداردهی اولیه مخزن |
| `git add .` | stage کردن تمام تغییرات |
| `git commit -m "msg"` | کامیت کردن تغییرات stage شده |
| `git remote add origin URL` | اضافه کردن مخزن راه دور |
| `git push -u origin main` | پوش به GitHub |
| `git restore <file>` | بازیابی فایل به آخرین کامیت |
| `git restore .` | بازیابی تمام فایل‌ها |
| `git reset --hard <commit>` | بازنشانی مخزن به کامیت خاص |
| `git restore --staged <file>` | unstaged کردن فایل |
| `git reset --soft HEAD~1` | soft reset (نگه داشتن تغییرات) |
| `git status` | بررسی وضعیت مخزن |
| `git log --oneline` | مشاهده تاریخچه کامیت |

## معیارهای ارزیابی

- [ ] مخزن GitHub با موفقیت ایجاد شده
- [ ] احراز هویت Personal Access Token کار می‌کند
- [ ] مخزن با استفاده از PAT در فرمت URL کلون شده
- [ ] عملیات بازیابی فایل نمایش داده شده
- [ ] عملیات بازیابی کامیت نمایش داده شده
- [ ] پیام‌های کامیت مناسب استفاده شده
- [ ] اطلاعات دانشجو در تمام فایل‌ها گنجانده شده
- [ ] ساختار مخزن با مشخصات مطابقت دارد
- [ ] مستندات فایل‌ها ایجاد و کامیت شده

## عیب‌یابی

### مشکلات احراز هویت:
۱. **"Authentication failed"**: PAT خود را تأیید کنید و مطمئن شوید که scopes مناسب دارد
۲. **"Repository not found"**: نام مخزن و نام کاربری را در URL بررسی کنید
۳. **PAT منقضی شده**: اگر منقضی شده یک token جدید ایجاد کنید

### مشکلات عملیات بازیابی:
۱. **"fatal: ambiguous argument"**: از هش کامیت کامل به جای هش کوتاه استفاده کنید
۲. **تغییرات بازیابی نشده**: اطمینان حاصل کنید که از دستور restore صحیح استفاده می‌کنید
۳. **هشدار hard reset**: hard reset تغییرات را به طور دائمی حذف می‌کند - با احتیاط استفاده کنید

### دستورات مفید برای اشکال‌زدایی:
```bash
# پیکربندی remote را بررسی کنید
git remote -v

# شاخه فعلی را بررسی کنید
git branch

# اطلاعات کامیت دقیق را ببینید
git show <commit-hash>

# ببینید چه چیزی بازیابی خواهد شد
git diff <file>
```

## نکات امنیتی

- **هرگز PAT خود را در version control کامیت نکنید**
- **از PATها با scopes مورد نیاز حداقل استفاده کنید**
- **tokenها را به طور دوره‌ای بازسازی کنید**
- **tokenها را در password manager ذخیره کنید**

## مراحل بعدی

پس از تکمیل این تمرین، باید راحت باشید با:
- ایجاد و مدیریت مخازن GitHub
- استفاده از Personal Access Tokens برای احراز هویت
- انجام انواع عملیات بازیابی Git
- درک تفاوت انواع reset مختلف
- مدیریت موثر مخازن راه دور